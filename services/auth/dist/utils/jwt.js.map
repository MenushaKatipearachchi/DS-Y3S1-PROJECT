{
  "version": 3,
  "sources": ["../../src/utils/jwt.js"],
  "sourcesContent": ["import jwt from \"jsonwebtoken\";\nimport { moduleLogger } from \"@sliit-foss/module-logger\";\nimport config from \"../config\";\nimport { errors } from \"./constants\";\n\nconst logger = moduleLogger(\"Jwt-util\");\n\nexport const verify = (token, ignoreExpiry = false) => {\n  try {\n    const verificationMethod = ignoreExpiry ? \"decode\" : \"verify\";\n    return jwt[verificationMethod](token, config.JWT_SECRET);\n  } catch (error) {\n    logger.error(`Jwt verification failed - ${error.message}`);\n    if (error.message === \"jwt expired\") {\n      throw errors.token_expired;\n    }\n    throw errors.invalid_token;\n  }\n};\n\nexport const generateTokens = (user) => {\n  [\"password\", \"created_at\", \"updated_at\"].forEach((key) => delete user[key]);\n\n  //  access token\n  const accessToken = jwt.sign(user, config.JWT_SECRET, {\n    expiresIn: config.ACCESS_TOKEN_EXPIRY,\n  });\n\n  //  refresh token\n  const refreshToken = jwt.sign(\n    {\n      access_token: accessToken,\n    },\n    config.JWT_SECRET,\n    {\n      expiresIn: config.REFRESH_TOKEN_EXPIRY,\n    }\n  );\n  return { access_token: accessToken, refresh_token: refreshToken };\n};\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAgB;AAChB,2BAA6B;AAC7B,oBAAmB;AACnB,uBAAuB;AAEvB,MAAM,aAAS,mCAAa,UAAU;AAE/B,MAAM,SAAS,wBAAC,OAAO,eAAe,UAAU;AACrD,MAAI;AACF,UAAM,qBAAqB,eAAe,WAAW;AACrD,WAAO,oBAAAA,QAAI,kBAAkB,EAAE,OAAO,cAAAC,QAAO,UAAU;AAAA,EACzD,SAAS,OAAP;AACA,WAAO,MAAM,6BAA6B,MAAM,SAAS;AACzD,QAAI,MAAM,YAAY,eAAe;AACnC,YAAM,wBAAO;AAAA,IACf;AACA,UAAM,wBAAO;AAAA,EACf;AACF,GAXsB;AAaf,MAAM,iBAAiB,wBAAC,SAAS;AACtC,GAAC,YAAY,cAAc,YAAY,EAAE,QAAQ,CAAC,QAAQ,OAAO,KAAK,GAAG,CAAC;AAG1E,QAAM,cAAc,oBAAAD,QAAI,KAAK,MAAM,cAAAC,QAAO,YAAY;AAAA,IACpD,WAAW,cAAAA,QAAO;AAAA,EACpB,CAAC;AAGD,QAAM,eAAe,oBAAAD,QAAI;AAAA,IACvB;AAAA,MACE,cAAc;AAAA,IAChB;AAAA,IACA,cAAAC,QAAO;AAAA,IACP;AAAA,MACE,WAAW,cAAAA,QAAO;AAAA,IACpB;AAAA,EACF;AACA,SAAO,EAAE,cAAc,aAAa,eAAe,aAAa;AAClE,GAnB8B;",
  "names": ["jwt", "config"]
}
